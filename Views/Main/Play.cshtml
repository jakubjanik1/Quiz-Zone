@using Quiz_Zone.Models
@model IEnumerable<Question>

@{
    Layout = "~/Views/_Layout.cshtml";
}

<div id="content"></div>
<div id="numOfQuestion"></div>
<div id="answerGrid">
    <div onclick="check('A')" class="answer">
        <div class="icon">A</div>
        <div id="answerA" class="answerContent"></div>
    </div>
    <div onclick="check('B')" class="answer">
        <div class="icon">B</div>
        <div id="answerB" class="answerContent"></div>
    </div>
    <div onclick="check('C')" class="answer">
        <div class="icon">C</div>
        <div id="answerC" class="answerContent"></div>
    </div>
    <div onclick="check('D')" class="answer">
        <div class="icon">D</div>
        <div id="answerD" class="answerContent"></div>
    </div>
</div>
<div id="result"></div>
<div id="score">Twój wynik:<br><span id="scoreNum">0</span></div>
<script>
    var rawJson = '@Html.Raw(Json.Encode(Model))';
    var questions = JSON.parse(rawJson);
    var numOfQuestion = 0;
    var score = 0;

    generateQuestion(numOfQuestion);

    function check(myAnswer)
    {
        if (myAnswer == questions[numOfQuestion].GoodAnswer)
        {
            score++;
            document.getElementById("result").innerHTML = "Poprawna odpowiedź!!!";
            document.getElementById("scoreNum").innerHTML = score;
        }
        else
        {
            document.getElementById("result").innerHTML = "Niepoprawna odpowiedź!!!";
        }

        if (numOfQuestion < @Model.Count() - 1)
        {
            setTimeout("generateQuestion(++numOfQuestion)", 1000);
        }
        else
        {
            setTimeout("summary()", 1000);
        }            
    }

    function generateQuestion(index)
    {
        document.getElementById("content").innerHTML = questions[index].Content;
        document.getElementById("numOfQuestion").innerHTML = "PYTANIE " + (numOfQuestion+1) + " Z " + @Model.Count();
        document.getElementById("answerA").innerHTML = questions[index].AnswerA;
        document.getElementById("answerB").innerHTML = questions[index].AnswerB;
        document.getElementById("answerC").innerHTML = questions[index].AnswerC;
        document.getElementById("answerD").innerHTML = questions[index].AnswerD; 
        document.getElementById("result").innerHTML = "";       
    }

    function summary()
    {
        @*document.write("<h1>Twój wynik to: " + score + "</h1><h3>Gratulacje!</h3>");
        document.write('@Html.ActionLink("Powrót do quizów", "Quizzes")');
        document.write('@Html.ActionLink("Jeszcze raz", "Play", new { category = Model.ElementAt(0).Category })');*@
    }
</script>